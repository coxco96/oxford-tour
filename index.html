<!DOCTYPE html>
<html>

<head>
  <title>My map</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
    integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
    crossorigin="" />
  <style>
    body {
      margin: 0;
      padding: 0;
    }

    h1 {
      font-family: 'Courier New', Courier, monospace;
    }

    #container {
      display: flex;
      flex-direction: row;
      width: 100%;
    }

    #iiif-map {
      height: 100vh;
      width: 70%;
      top: 0;
      bottom: 0;
    }

    #info-column {
      width: 30%;
      color: black;
      background-color: lightcyan;
      padding: 1em;
    }

    #current-view {
      position: absolute;
      left: 60px;
      top: 12px;
      z-index: 1000;
      background: whitesmoke;
      padding: 8px 12px;
    }

    #ui {
      position: absolute;
      left: 12px;
      bottom: 12px;
      z-index: 1000;
      background: whitesmoke;
      padding: 8px 12px;
    }

    a {
      text-decoration: none;
      display: inline-block;
      padding: 8px 16px;
    }

    a:hover {
      background-color: rgba(0, 0, 0, 0.8);
      color: white;
    }

    #previous,
    #next {
      cursor: pointer;
      width: auto;
      color: BLACK;
      font-weight: bold;
      font-size: 18px;
      border-radius: 0 3px 3px 0;
      user-select: none;
    }



    .tour-location {
      display: none;
      font-family: monospace;
    }

    img {
      padding: 10px;
      margin: auto;
    }



    .active {
      background-color: #717171;
    }
  </style>
</head>

<body>
  <div id=container>
    <div id="iiif-map"></div>
    <div id="info-column">
      <h1>Take a tour of the city of Oxford and its unviersity.</h1>

      <div id="back-and-forth">
        <a href="#" id="previous" onclick="plusSlides(-1)">&#8249; Previous</a>
        <a href="#" id="next" onclick="plusSlides(1)">Next &#8250;</a>
      </div>

      <div id="first-stop" class="tour-location">

        <img src="https://www.britainexpress.com/images/attractions/editor3/Magdalene-7814.jpg" style="width:100%"
          alt="photo of Magdalen College">
        <div class="text">first one</div>

      </div>
      <div id="second-stop" class="tour-location"><img
          src="https://i.guim.co.uk/img/media/dcb0fee186850e5eaf5eebcd6d0589614f830e6e/0_233_3500_2101/master/3500.jpg?width=465&quality=45&auto=format&fit=max&dpr=2&s=4b06629f2c3f570d0bdff15599909ba8"
          style="width:100%" alt="photo of Magdalen College">
        <div class="text">second one</div>
      </div>
      <div id="third-stop" class="tour-location"><img
          src="https://www.britainexpress.com/images/attractions/editor3/Magdalene-7814.jpg" style="width:100%"
          alt="photo of Magdalen College">
        <div class="text">third one</div>
      </div>
      <div id="fourth-stop" class="tour-location"><img
          src="https://i.guim.co.uk/img/media/dcb0fee186850e5eaf5eebcd6d0589614f830e6e/0_233_3500_2101/master/3500.jpg?width=465&quality=45&auto=format&fit=max&dpr=2&s=4b06629f2c3f570d0bdff15599909ba8"
          style="width:100%" alt="photo of Magdalen College">
        <div class="text">fourth one</div>
      </div>
      <div id="fifth-stop" class="tour-location"><img
          src="https://www.britainexpress.com/images/attractions/editor3/Magdalene-7814.jpg" style="width:100%"
          alt="photo of Magdalen College">
        <div class="text">fifth one</div>
      </div>


    </div>



    <div id="current-view">
      Current bounds:<br />
      <div id="current-bounds"></div>
    </div>
    <div id="ui">
      <button id="zoom-to-full-screen">Back to full screen map</button>
    </div>




  </div>



  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
    integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
    crossorigin=""></script>
  <!-- make sure to import Leaflet-IIIF *after* the main Leaflet package -->
  <script src="https://cdn.rawgit.com/mejackreed/Leaflet-IIIF/v3.0.0/leaflet-iiif.js"></script>

  <script>
    const map = L.map("iiif-map", {
      center: [0, 0],
      crs: L.CRS.Simple,
      zoom: 2,
      maxZoom: 1,
      zoomSnap: .2
    });

    map.setMaxZoom(3.2);

    const chamizalLayer = new L.tileLayer.iiif(
      "https://iiif.digitalcommonwealth.org/iiif/2/commonwealth:k643f906k/info.json"
    ).addTo(map);



    map.on("moveend", () => {
      // returns 'southwest_lng,southwest_lat,northeast_lng,northeast_lat' of current view
      const currentBounds = map.getBounds().toBBoxString();

      // output current bounds to screen
      document.getElementById("current-bounds").innerText = currentBounds;
    });

    document
      .getElementById("zoom-to-full-screen")
      .addEventListener("click", () => {
        map.flyToBounds([
          [-550.49, 0],
          [-71.49, 902],
        ]);
      });





    oxfordLocations = {
      id: {

        1: {
          name: "Magdalen College",
          latlng: [
            [-464.3, 635.7],
            [-224.8, 945.7]
          ],
          description: "",
          mapNum: 1
        },

        2: {
          name: "All Souls",
          latlng: [
            [-303.6, 467.4],
            [-183.8, 622.4]
          ],
          description: "",
          mapNum: 7
        },

        3: {
          name: "Radcliffe Library",
          latlng: [
            [-295.5, 430.9],
            [-191.3, 565.8]
          ],
          description: "",
          mapNum: 11
        },

        4: {
          name: "Bodleian D.",
          latlng: [
            [-282.2, 448],
            [-162.5, 603]
          ],
          description: "",
          mapNum: 12
        },

        5: {
          name: "The Market",

          latlng: [
            [-288.7, 236.6],
            [-145.5, 421.2]
          ],
          description: "",
          mapNum: 16
        },

      }
    }


    // logs name of each location
   // for (const key in oxfordLocations.id) {
      //console.log(oxfordLocations.id[key]["latlng"]);
      //console.log(oxfordLocations.id[key]["latlng"])
    //}
  //  let newArr = Object.values(oxfordLocations.id[1]["latlng"]);
  //  console.log(newArr);
  //   console.log(Object.values(newArr));


    console.log(showSlides(7));

    var slideIndex = 1;
    showSlides(slideIndex);

    // functions

    // Thumbnail image controls
    function currentSlide(n) {
      showSlides(slideIndex = n);
    }


    function showSlides(n) {
      let i;
      let slides = document.getElementsByClassName("tour-location");


      // how many locations do we have?
      console.log(slides.length);

      if (n > slides.length) {
        slideIndex = 1
      }
      if (n < 1) {
        slideIndex = slides.length
      }
      for (let i = 0; i < slides.length; i++) {
        slides[i].style.display = "none";
      }

      slides[slideIndex - 1].style.display = "block";

      // if we are on first location, take us to the second location on "next" click.
      if (slideIndex == 1) {
        console.log("hey!");
        document
          .getElementById("next")
          .addEventListener("click", () => {
            map.flyToBounds([
            Object.values(oxfordLocations.id[2]["latlng"])
            ]);
          });
      } else if (slideIndex == 2) {
        document
          .getElementById("next")
          .addEventListener("click", () => {
            map.flyToBounds([
              // [-295.5, 430.9],
              // [-191.3, 565.8]
              Object.values(oxfordLocations.id[3]["latlng"])
            ]);
          }),
          document
          .getElementById("previous")
          .addEventListener("click", () => {
            map.flyToBounds([
              // [-303.6, 467.4],
              // [-183.8, 622.4]
              Object.values(oxfordLocations.id[1]["latlng"])
            ]);
          });
      } else if (slideIndex == 3) {
        document
          .getElementById("next")
          .addEventListener("click", () => {
            map.flyToBounds([
              // [-295.5, 430.9],
              // [-191.3, 565.8]
              Object.values(oxfordLocations.id[4]["latlng"])
            ]);
          }),
          document
          .getElementById("previous")
          .addEventListener("click", () => {
            map.flyToBounds([
              // [-303.6, 467.4],
              // [-183.8, 622.4]
              Object.values(oxfordLocations.id[2]["latlng"])
            ]);
          });
      } else if (slideIndex == 4) {
        document
          .getElementById("next")
          .addEventListener("click", () => {
            map.flyToBounds([
              // [-295.5, 430.9],
              // [-191.3, 565.8]
              Object.values(oxfordLocations.id[5]["latlng"])
            ]);
          }),
          document
          .getElementById("previous")
          .addEventListener("click", () => {
            map.flyToBounds([
              // [-303.6, 467.4],
              // [-183.8, 622.4]
              Object.values(oxfordLocations.id[3]["latlng"])
            ]);
          });
      } else if (slideIndex == 5) {
        document
          .getElementById("next")
          .addEventListener("click", () => {
            map.flyToBounds([
              // [-295.5, 430.9],
              // [-191.3, 565.8]
              Object.values(oxfordLocations.id[1]["latlng"])
            ]);
          }),
          document
          .getElementById("previous")
          .addEventListener("click", () => {
            map.flyToBounds([
              // [-303.6, 467.4],
              // [-183.8, 622.4]
              Object.values(oxfordLocations.id[4]["latlng"])
            ]);
          });
      }




    }


    // Next/previous controls
    function plusSlides(n) {
      showSlides(slideIndex += n);
    }
  </script>
</body>

</html>